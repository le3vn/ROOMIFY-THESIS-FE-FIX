(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[49],{7838:function(e,l,t){"use strict";t.d(l,{Z:function(){return s}});var n=t(7294);function s(){let[,e]=n.useReducer(e=>e+1,0);return e}},8744:function(e,l,t){(window.__NEXT_P=window.__NEXT_P||[]).push(["/booking/[id]",function(){return t(6400)}])},6400:function(e,l,t){"use strict";t.r(l),t.d(l,{default:function(){return S}});var n=t(5893),s=t(7294),a=t(1163),i=t(3939),o=t(161),d=t(1061),c=t(9734),r=t(7814),u=t(9417),m=t(1835),x=t(6738),h=t(6985),v=t(1693),p=t(8662),f=t(3299);let b=e=>{let{visible:l,onConfirm:t,onCancel:s}=e;return(0,n.jsxs)("div",{className:"fixed inset-0 flex flex-col justify-center items-center bg-black bg-opacity-50 z-auto ".concat(l?"":"hidden"),children:[(0,n.jsx)("div",{className:"bg-purple-950 p-4 absolute top-32 rounded-full border-white border-4",children:(0,n.jsx)("img",{src:"/Assets/images/are-you-sure.png",alt:"",className:"w-[200px] rounded-full"})}),(0,n.jsx)("div",{className:"bg-white p-4 rounded-lg w-2/5 h-2/5",children:(0,n.jsxs)("div",{className:"h-full",children:[(0,n.jsx)("div",{className:"h-2/3 flex flex-col justify-end",children:(0,n.jsxs)("div",{className:"flex flex-col items-center",children:[(0,n.jsx)("h1",{className:"text-2xl font-bold",children:"Submit Booking ?"}),(0,n.jsx)("h4",{className:"text-center",children:"Make sure to input the right data and requirements :)"})]})}),(0,n.jsx)("div",{className:"h-1/3 flex items-center justify-center",children:(0,n.jsxs)("div",{className:"flex gap-4",children:[(0,n.jsx)("button",{className:"bg-purple-950 h-[50px] w-[150px] rounded-full text-white text-lg font-semibold",onClick:t,children:"Submit"}),(0,n.jsx)("button",{className:"bg-gray-200 h-[50px] w-[150px] rounded-full text-black text-lg font-semibold",onClick:s,children:"Cancel"})]})})]})})]})};var j=t(6551);let g=e=>{let{visible:l,onConfirm:t,isSuccess:s,onCancel:a}=e;return(0,n.jsxs)("div",{className:"fixed inset-0 flex flex-col justify-center items-center bg-black bg-opacity-50 z-auto ".concat(l?"":"hidden"),children:[(0,n.jsx)("div",{className:"bg-purple-950 p-4 absolute top-32 rounded-full border-white border-4",children:(0,n.jsx)("img",{src:s?"/Assets/images/succeed.png":"/Assets/images/person-sad.png",alt:"",className:"w-[200px] rounded-full"})}),(0,n.jsx)("div",{className:"bg-white p-4 rounded-lg w-2/5 h-2/5",children:(0,n.jsxs)("div",{className:"h-full",children:[(0,n.jsx)("div",{className:"h-2/3 flex flex-col justify-end",children:s?(0,n.jsxs)("div",{className:"flex flex-col items-center px-8",children:[(0,n.jsx)("h1",{className:"text-2xl font-bold",children:"You're All Set !"}),(0,n.jsx)("h4",{className:"text-center",children:"Your booking has been submitted. Check your ongoing page for your booking approvals !"})]}):(0,n.jsxs)("div",{className:"flex flex-col items-center",children:[(0,n.jsx)("h1",{className:"text-2xl font-bold",children:"Oh no..."}),(0,n.jsx)("h4",{className:"text-center",children:"Something just happened. Try again later."})]})}),(0,n.jsx)("div",{className:"h-1/3 flex items-center justify-center",children:(0,n.jsx)("div",{className:"flex gap-4",children:(0,n.jsx)("button",{className:"bg-purple-950 h-[50px] w-[150px] rounded-full text-white text-lg font-semibold",onClick:s?t:a,children:s?"Okay, Great!":"Okay :("})})})]})})]})},N={token:{colorBgContainerDisabled:"#ffffff"}},w=()=>{var e,l,t,o,w,S,k,y,I,C,q,E,Z,O,L,z,F;let _=(0,a.useRouter)(),{id:A,date:B}=_.query,[P,D]=(0,s.useState)(!1),[R,U]=(0,s.useState)(!1),[T,G]=(0,s.useState)(!1),[X,Y]=(0,s.useState)(void 0),[M,$]=(0,s.useState)(void 0),H=(0,i.f)(),{data:J}=(0,f.useSession)(),K=null==J?void 0:J.user,[Q,V]=(0,s.useState)([]),W=null==K?void 0:K.id,{data:ee}=(0,c.ZP)("".concat(d.j.getDisplayName,"?UserId=").concat(W,"&RoleName=").concat(null==K?void 0:null===(e=K.role)||void 0===e?void 0:e[0]),H),{fetchPOSTWithFormData:el}=(0,j.L)(),{data:et,error:en}=(0,c.ZP)("".concat(d.j.getAvailableSession,"?RoomId=").concat(A,"&Date=").concat(B),H),{data:es}=(0,c.ZP)("".concat(d.j.getAllEquipment),H),{data:ea}=(0,c.ZP)("".concat(d.j.getInstituteId,"?UserId=").concat(W),H),{data:ei}=(0,c.ZP)("".concat(d.j.getLecturerSubject,"?LecturerId=").concat(W),H),eo=(null==et?void 0:et.availableSessions)||[],ed=es||[];if(en)return(0,n.jsx)("p",{children:"Error loading available sessions."});if(!et)return(0,n.jsx)("p",{children:"Loading..."});let ec=()=>{_.back()},er=e=>{V(e.fileList||[])},eu=async()=>{var e,l,t,n,s,a,i,o;let c=new FormData,r=[],u=[];document.querySelectorAll("input[name='sessionIds']:checked").forEach(e=>{r.push(e.value)}),document.querySelectorAll("input[name='equipmentIds']:checked").forEach(e=>{u.push(e.value)});let m=(null===(e=document.querySelector('input[name="eventName"]'))||void 0===e?void 0:e.value)||"",x=(null===(l=document.querySelector('input[name="institutionalId"]'))||void 0===l?void 0:l.value)||"";if((null==K?void 0:null===(t=K.role)||void 0===t?void 0:t[0])==="Lecturer"&&(m="".concat(X," - ").concat(M)),c.append("BookingDescription",m),c.append("InstitutionalId",x),c.append("UserId",W),c.append("BookingDate",B),c.append("RoomId",A),(null==K?void 0:null===(n=K.role)||void 0===n?void 0:n[0])==="StudentOrganization"&&Q.length>0?c.append("Evidence",null===(i=Q[0])||void 0===i?void 0:i.originFileObj):c.append("Evidence",""),c.append("FullName",(null==K?void 0:K.name)||""),r.forEach(e=>{c.append("SessionBookedList",e)}),u.forEach(e=>{c.append("EquipmentBookedList",e)}),(null==K?void 0:null===(s=K.role)||void 0===s?void 0:s[0])==="StudentOrganization"||(null==K?void 0:null===(a=K.role)||void 0===a?void 0:a[0])==="Staff"){let e=(null===(o=document.querySelector('input[name="organizationName"]'))||void 0===o?void 0:o.value)||"";c.append("OrganizationName",e)}try{let e=await el(d.j.createBooking,c);e.data?G(!0):G(!1)}catch(e){G(!1)}},em=()=>{D(!1)},ex=()=>{eu(),D(!1),U(!0)},eh=()=>{U(!1),_.push("/ongoing")},ev=()=>{U(!1)};return(0,n.jsx)(m.ZP,{theme:N,children:(0,n.jsxs)("div",{className:"mt-4",children:[(0,n.jsx)("button",{className:"bg-white rounded-full w-10 h-10 flex items-center justify-center",onClick:ec,children:(0,n.jsx)(r.G,{icon:u.A35,className:"inline"})}),(0,n.jsxs)("div",{className:"mt-6 overflow-y-auto h-[620px]",children:[(0,n.jsx)("img",{src:"/Assets/images/booking-title.png",alt:"",width:720,height:100,className:"mb-6"}),(0,n.jsxs)("div",{children:[(0,n.jsxs)("div",{children:[(0,n.jsx)("p",{className:"mb-2 text-base text-white font-normal",children:"Full Name"}),(0,n.jsx)(x.Z,{type:"text",className:"w-full mb-3 rounded-lg h-8",disabled:!0,value:null!==(O=null==K?void 0:K.name)&&void 0!==O?O:""})]}),(0,n.jsx)("div",{className:"bg-orange-200-300",children:(null==K?void 0:null===(l=K.role)||void 0===l?void 0:l[0])==="StudentOrganization"||(null==K?void 0:null===(t=K.role)||void 0===t?void 0:t[0])==="Student"?(0,n.jsxs)("div",{children:[(0,n.jsx)("p",{className:"mb-2 text-base text-white font-normal",children:"Student ID"}),(0,n.jsx)(x.Z,{type:"text",className:"w-full mb-3 rounded-lg h-8",disabled:!0,value:null!==(L=null==ea?void 0:ea.studentsId)&&void 0!==L?L:"",name:"institutionalId"})]}):(null==K?void 0:null===(o=K.role)||void 0===o?void 0:o[0])==="Lecturer"?(0,n.jsxs)("div",{children:[(0,n.jsx)("p",{className:"mb-2 text-base text-white font-normal",children:"Lecturer ID"}),(0,n.jsx)(x.Z,{type:"text",className:"w-full mb-3 rounded-lg h-8",disabled:!0,value:null!==(z=null==ea?void 0:ea.lecturersId)&&void 0!==z?z:"",name:"institutionalId"})]}):(null==K?void 0:null===(w=K.role)||void 0===w?void 0:w[0])==="Staff"?(0,n.jsxs)("div",{children:[(0,n.jsx)("p",{className:"mb-2 text-base text-white font-normal",children:"Staff ID"}),(0,n.jsx)(x.Z,{type:"text",className:"w-full mb-3 rounded-lg h-8",disabled:!0,value:null!==(F=null==ea?void 0:ea.staffsId)&&void 0!==F?F:"",name:"institutionalId"})]}):(0,n.jsx)("p",{className:"mb-2 text-base text-white font-normal",children:"Unknown Role"})}),(0,n.jsx)("div",{children:(null==K?void 0:null===(S=K.role)||void 0===S?void 0:S[0])==="Student"||(null==K?void 0:null===(k=K.role)||void 0===k?void 0:k[0])==="StudentOrganization"||(null==K?void 0:null===(y=K.role)||void 0===y?void 0:y[0])==="Staff"?(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("p",{className:"mb-2 text-base text-white font-normal",children:"Event Name"}),(0,n.jsx)(x.Z,{type:"text",className:"w-full mb-3 rounded-lg h-8",name:"eventName"})]}):(null==K?void 0:null===(I=K.role)||void 0===I?void 0:I[0])==="Lecturer"?(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("p",{className:"mb-2 text-base text-white font-normal",children:"Subject"}),(0,n.jsx)(h.Z,{className:"w-full mb-3 rounded-lg h-8",placeholder:"Select a Subject",value:X,onChange:e=>Y(e),options:null==ei?void 0:ei.map(e=>({label:e.subjectName,value:e.subjectName}))})]}):(0,n.jsx)("p",{className:"mb-3",children:"Unknown Role"})}),(0,n.jsxs)("div",{children:[(null==K?void 0:null===(C=K.role)||void 0===C?void 0:C[0])==="StudentOrganization"&&(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("p",{className:"mb-2 text-base text-white font-normal",children:"Student Organization Name"}),(0,n.jsx)(x.Z,{type:"text",className:"w-full mb-3 rounded-lg h-8",disabled:!0,value:null==ee?void 0:ee.name,name:"organizationName"})]}),(null==K?void 0:null===(q=K.role)||void 0===q?void 0:q[0])==="Staff"&&(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("p",{className:"mb-2 text-base text-white font-normal",children:"Office/Center Name"}),(0,n.jsx)(x.Z,{type:"text",className:"w-full mb-3 rounded-lg h-8",disabled:!0,value:null==ee?void 0:ee.name,name:"organizationName"})]}),(null==K?void 0:null===(E=K.role)||void 0===E?void 0:E[0])==="Lecturer"&&(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("p",{className:"mb-2 text-base text-white font-normal",children:"Booking Purpose"}),(0,n.jsx)(h.Z,{className:"w-full mb-3 rounded-lg h-8",value:M,onChange:e=>$(e),options:[{value:"Class Replacement",label:"Class Replacement"},{value:"New Class",label:"New Class"},{value:"Extra Class",label:"Extra Class"}]})]})]}),(0,n.jsxs)("div",{children:[(0,n.jsx)("p",{className:"mb-2 text-base text-white font-normal",children:"Session Booked"}),(0,n.jsx)("div",{className:"grid grid-cols-2 mb-3",children:eo.length>0?eo.map(e=>(0,n.jsxs)("div",{className:"flex items-center",children:[(0,n.jsx)("input",{type:"checkbox",id:"session-".concat(e.sessionId),name:"sessionIds",value:e.sessionId,className:"mr-2 grid-cols-2"}),(0,n.jsx)("label",{htmlFor:"session-".concat(e.sessionId),className:"text-white text-base font-thin",children:e.sessionName})]},e.sessionId)):(0,n.jsx)("p",{children:"No sessions available"})})]}),(0,n.jsxs)("div",{children:[(0,n.jsx)("p",{className:"mb-2 text-base text-white font-normal",children:"Technical Support"}),(0,n.jsx)("div",{className:"grid grid-cols-2 mb-3",children:ed.length>0?ed.map(e=>(0,n.jsxs)("div",{className:"flex items-center",children:[(0,n.jsx)("input",{type:"checkbox",id:"equipment-".concat(e.equipmentId),name:"equipmentIds",value:e.equipmentId,className:"mr-2 grid-cols-2"}),(0,n.jsx)("label",{htmlFor:"equipment-".concat(e.equipmentId),className:"text-white text-base font-thin",children:e.equipmentName})]},e.equipmentId)):(0,n.jsx)("p",{children:"No equipment available"})})]}),(0,n.jsx)("div",{children:(null==K?void 0:null===(Z=K.role)||void 0===Z?void 0:Z[0])==="StudentOrganization"&&(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("p",{className:"mb-2 text-base text-white font-normal",children:"Evidence of Approval"}),(0,n.jsx)(v.Z,{fileList:null!=Q?Q:[],onChange:er,showUploadList:!0,className:"text-white",maxCount:1,children:(0,n.jsxs)(p.ZP,{className:"bg-white border-black text-black text-base",children:[(0,n.jsx)(r.G,{icon:u.cf$,className:"mr-2"}),"Click to Upload"]})})]})}),(0,n.jsx)("div",{className:"flex justify-center mt-4",children:(0,n.jsx)("button",{className:"bg-purple-950 px-14 py-2 font-bold text-white rounded-full text-xl",onClick:()=>D(!0),children:"Submit Booking"})}),(0,n.jsx)(b,{visible:P,onConfirm:ex,onCancel:em}),(0,n.jsx)(g,{visible:R,onConfirm:eh,isSuccess:T,onCancel:ev})]})]})]})})};w.layout=o.f;var S=w}},function(e){e.O(0,[976,634,738,397,693,161,774,888,179],function(){return e(e.s=8744)}),_N_E=e.O()}]);
//# sourceMappingURL=[id]-2f0d6b7f5c802020.js.map