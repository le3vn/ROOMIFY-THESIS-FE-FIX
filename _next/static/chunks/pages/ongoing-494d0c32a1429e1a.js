(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[325],{6644:function(e,s,l){(window.__NEXT_P=window.__NEXT_P||[]).push(["/ongoing",function(){return l(5753)}])},5990:function(e,s,l){"use strict";var a=l(5893),t=l(7294),i=l(6551),n=l(1061),d=l(7814),c=l(9417);let o=e=>{let{isOpen:s,onClose:l,bookingId:o,roomName:r,bookingName:x}=e,{fetchGET:h}=(0,i.L)(),[u,m]=(0,t.useState)(void 0),[p,g]=(0,t.useState)(!1),f=async e=>{if(e){g(!0);try{let s=await h("".concat(n.j.getRejectMessage,"?BookingId=").concat(e));m(s.data)}catch(e){console.error("Failed to fetch reject message:",e)}finally{g(!1)}}};return(0,t.useEffect)(()=>{s&&o&&f(o)},[s,o]),(0,a.jsxs)("div",{className:"fixed inset-0 flex flex-col justify-center items-center bg-black bg-opacity-10 z-50 ".concat(s?"":"hidden"),children:[(0,a.jsx)("div",{className:"bg-purple-950 p-4 absolute top-11 rounded-full border-white border-4",children:(0,a.jsx)("img",{src:"/Assets/images/person-sad.png",alt:"",className:"w-[200px] rounded-full"})}),(0,a.jsx)("div",{className:"bg-white p-4 rounded-lg w-2/5 h-3/5",children:(0,a.jsxs)("div",{className:" h-full flex flex-col justify-between",children:[(0,a.jsxs)("div",{className:"grid grid-row-2 gap-0 max-h-[200px]",children:[(0,a.jsx)("div",{className:"h-[100px]",children:(0,a.jsx)("div",{className:"flex justify-end",children:(0,a.jsx)("button",{className:"bg-gray-200 w-10 h-10 rounded-full",onClick:l,children:(0,a.jsx)(d.G,{icon:c.EOp})})})}),(0,a.jsx)("div",{className:"flex justify-center items-center h-[100px]",children:(0,a.jsx)("p",{className:"text-2xl font-bold",children:"Oh no, your booking was rejected..."})})]}),(0,a.jsx)("div",{className:"bg-gray-200 p-4 border-2 h-full border-gray-400 rounded-lg ",children:p?(0,a.jsx)("p",{children:"loading..."}):u?(0,a.jsxs)("div",{className:"h-full flex flex-col",children:[(0,a.jsx)("div",{className:"mb-4",children:(0,a.jsxs)("p",{className:"font-bold text-xl",children:[r," - ",x]})}),(0,a.jsxs)("div",{className:"flex-grow flex flex-col justify-between",children:[(0,a.jsxs)("div",{className:"flex",children:[(0,a.jsx)("div",{className:"w-1/5",children:(0,a.jsx)("img",{src:u.minioUrl,alt:"",className:"w-11 h-11 rounded-full"})}),(0,a.jsx)("div",{className:"w-4/5 flex items-center",children:(0,a.jsxs)("p",{children:['"',u.rejectMessage,'"']})})]}),(0,a.jsx)("div",{className:"text-gray-400",children:(0,a.jsxs)("p",{children:["Rejected by ",u.createdBy," at ",u.createdAt]})})]})]}):(0,a.jsx)("p",{children:x})})]})})]})};s.Z=o},5753:function(e,s,l){"use strict";l.r(s),l.d(s,{default:function(){return j}});var a=l(5893),t=l(7294),i=l(161),n=l(3939),d=l(9734),c=l(3299),o=l(1061),r=l(7814),x=l(9417),h=l(6551),u=l(5990);let m=e=>{let{visible:s,onConfirm:l,onCancel:t}=e;return(0,a.jsxs)("div",{className:"fixed inset-0 flex flex-col justify-center items-center bg-black bg-opacity-20 z-auto ".concat(s?"":"hidden"),children:[(0,a.jsx)("div",{className:"bg-purple-950 p-4 absolute top-32 rounded-full border-white border-4",children:(0,a.jsx)("img",{src:"/Assets/images/are-you-sure.png",alt:"",className:"w-[200px] rounded-full"})}),(0,a.jsx)("div",{className:"bg-white p-4 rounded-lg w-2/5 h-2/5",children:(0,a.jsxs)("div",{className:"h-full",children:[(0,a.jsx)("div",{className:"h-2/3 flex flex-col justify-end",children:(0,a.jsxs)("div",{className:"flex flex-col items-center",children:[(0,a.jsx)("h1",{className:"text-2xl font-bold",children:"Cancel Booking ?"}),(0,a.jsx)("h4",{className:"text-center",children:"Approvals you get for this booking (if any) will be annulled !"})]})}),(0,a.jsx)("div",{className:"h-1/3 flex items-center justify-center",children:(0,a.jsxs)("div",{className:"flex gap-4",children:[(0,a.jsx)("button",{className:"bg-red-600 h-[50px] w-[150px] rounded-full text-white text-lg font-semibold",onClick:l,children:"Yes"}),(0,a.jsx)("button",{className:"bg-gray-200 h-[50px] w-[150px] rounded-full text-black text-lg font-semibold",onClick:t,children:"Cancel"})]})})]})})]})},p=e=>{let{visible:s,onConfirm:l,isSuccess:t}=e;return(0,a.jsxs)("div",{className:"fixed inset-0 flex flex-col justify-center items-center bg-black bg-opacity-20 z-auto ".concat(s?"":"hidden"),children:[(0,a.jsx)("div",{className:"bg-purple-950 p-4 absolute top-32 rounded-full border-white border-4",children:(0,a.jsx)("img",{src:t?"/Assets/images/yes-okay.png":"/Assets/images/person-sad.png",alt:"",className:"w-[200px] rounded-full"})}),(0,a.jsx)("div",{className:"bg-white p-4 rounded-lg w-2/5 h-2/5",children:(0,a.jsxs)("div",{className:"h-full",children:[(0,a.jsx)("div",{className:"h-2/3 flex flex-col justify-end",children:t?(0,a.jsxs)("div",{className:"flex flex-col items-center px-8",children:[(0,a.jsx)("h1",{className:"text-2xl font-bold",children:"You're Booking is Cancelled"}),(0,a.jsx)("h4",{className:"text-center",children:"Your booking has been cancelled. We're waiting for your next booking !"})]}):(0,a.jsxs)("div",{className:"flex flex-col items-center",children:[(0,a.jsx)("h1",{className:"text-2xl font-bold",children:"Oh no..."}),(0,a.jsx)("h4",{className:"text-center",children:"Something just happened. Try again later."})]})}),(0,a.jsx)("div",{className:"h-1/3 flex items-center justify-center",children:(0,a.jsx)("div",{className:"flex gap-4",children:(0,a.jsx)("button",{className:"bg-purple-950 h-[50px] w-[150px] rounded-full text-white text-lg font-semibold",onClick:l,children:"Okay, Great !"})})})]})})]})},g=e=>{let{isOpen:s,onClose:l,qrUrl:t,bookingId:i,checkInPlace:n}=e;return(0,a.jsx)("div",{className:"fixed inset-0 flex flex-col justify-center items-center bg-black bg-opacity-30 z-50 ".concat(s?"":"hidden"),children:(0,a.jsx)("div",{className:"w-4/12 h-5/6 rounded-2xl flex flex-col",children:(0,a.jsxs)("div",{className:"h-full flex flex-col divide-y-4 divide-dashed divide-gray-400",children:[(0,a.jsxs)("div",{className:"bg-purple-950 h-1/3 rounded-t-3xl flex justify-between pt-4 pr-4",children:[(0,a.jsxs)("div",{className:"flex",children:[(0,a.jsx)("div",{className:"flex flex-col justify-end mr-8",children:(0,a.jsx)("img",{src:"/Assets/images/point-right.png",alt:"",className:"w-32 h-32"})}),(0,a.jsx)("div",{className:"flex flex-col justify-around",children:(0,a.jsxs)("div",{className:"text-white",children:[(0,a.jsx)("p",{className:"text-2xl pb-2",children:"Your Booking's"}),(0,a.jsx)("p",{className:"text-6xl pb-2",children:"QR Code"}),(0,a.jsx)("p",{className:"text-2xl",children:"Here !"})]})})]}),(0,a.jsx)("div",{children:(0,a.jsx)("button",{className:"bg-gray-200 w-10 h-10 rounded-full",onClick:l,children:(0,a.jsx)(r.G,{icon:x.EOp})})})]}),(0,a.jsxs)("div",{className:"bg-white h-3/4 rounded-b-3xl",children:[(0,a.jsxs)("div",{className:"py-8 flex flex-col justify-center items-center",children:[(0,a.jsx)("img",{src:t,alt:"",className:"w-40 h-40 mb-4 border-2 border-purple-950 rounded-lg"}),(0,a.jsx)("p",{className:"text-xs font-semibold",children:i})]}),(0,a.jsx)("div",{className:"px-14 py-6",children:(0,a.jsxs)("ol",{className:"list-decimal list-inside",children:[(0,a.jsxs)("li",{className:"text-sm",children:["Before using the room, check in using this QR Code in ",(0,a.jsx)("p",{className:"font-bold text-purple-950",children:n})]}),(0,a.jsx)("li",{className:"text-sm",children:"Booking will be automatically cancelled after 1 (one) hour if the booking isn't checked in."}),(0,a.jsx)("li",{className:"text-sm",children:"Make sure to keep the room and establishment neat and tidy."})]})})]})]})})})},f=()=>{var e;let s=(0,n.f)(),{data:l}=(0,c.useSession)(),i=null==l?void 0:l.user,f=null==i?void 0:null===(e=i.role)||void 0===e?void 0:e[0],j=null==i?void 0:i.id,[b,N]=(0,t.useState)(!1),[v,w]=(0,t.useState)(""),[y,k]=(0,t.useState)(""),[I,S]=(0,t.useState)(""),[C,B]=(0,t.useState)(""),[O,A]=(0,t.useState)(!1),[_,E]=(0,t.useState)(!1),[U,M]=(0,t.useState)(""),[R,H]=(0,t.useState)(""),[Y,P]=(0,t.useState)(!1),[z,G]=(0,t.useState)(!1),[L,T]=(0,t.useState)(!1),[D,Z]=(0,t.useState)([]),{data:q}=(0,d.ZP)("".concat(o.j.getUserBookingView,"?UserId=").concat(j,"&RoleName=").concat(f,"&IsCanceled=").concat(b),s),{fetchPOST:Q}=(0,h.L)();if((0,t.useEffect)(()=>{if(null==q?void 0:q.userBookings){let e=q.userBookings.filter(e=>b?e.approvalHistories.some(e=>4===e.approvalStatusId):!e.approvalHistories.some(e=>4===e.approvalStatusId));Z(e)}},[b,q]),!q)return(0,a.jsx)("div",{children:"Loading..."});let X=async()=>{try{let e=await Q(o.j.cancelBooking,{bookingId:U});e&&T(!0)}catch(e){T(!1)}},F=e=>{N(e)},V=(e,s)=>{H(s),A(!0),w(e)},W=()=>{X(),E(!1),P(!0)},J=()=>{P(!1),F(!0)},K=()=>{A(!1)},$=()=>{E(!1)},ee=(e,s,l)=>{G(!0),k(e),S(s),B(l)},es=()=>{G(!1)};return console.log(U),(0,a.jsxs)("div",{className:"mt-3 h-[650px]",children:[(0,a.jsx)("img",{src:"/Assets/images/Ongoing.png",alt:"Ongoing",width:410,height:40,className:"mt-16"}),(0,a.jsxs)("div",{className:"flex mt-4 mb-6",children:[(0,a.jsx)("button",{className:"rounded-md text-white text-xl ".concat(b?"":"underline"," ").concat(b?"":"underline-offset-8"),onClick:()=>F(!1),children:"Ongoing"}),(0,a.jsx)("button",{className:"rounded-md ml-8 text-white text-xl ".concat(b?"underline":""," ").concat(b?"underline-offset-8":""),onClick:()=>F(!0),children:"Canceled"})]}),(0,a.jsx)("div",{className:"mt-8 grid grid-cols-3 gap-5 overflow-y-auto h-[540px]",children:(null==D?void 0:D.length)>0?D.map(e=>{let s=e.approvalHistories[e.approvalHistories.length-1],l=(null==s?void 0:s.approvalStatusId)===2?"bg-purple-950 text-gray-400 border-yellow-400":"bg-gray-100 text-gray-400 border-gray-400",t=(null==s?void 0:s.approvalStatusId)===2?"text-yellow-400":"text-gray-400",i=(null==s?void 0:s.approvalStatusId)!==2,n=(null==s?void 0:s.approvalStatusId)===3,d=(null==s?void 0:s.approvalStatusId)===4;return(0,a.jsxs)("div",{className:"bg-white p-4 rounded-lg flex flex-col justify-between h-[510px] overflow-y-auto",children:[(0,a.jsx)("div",{className:"",children:(0,a.jsxs)("div",{className:"",children:[(0,a.jsx)("div",{className:"relative mb-4",children:(0,a.jsx)("img",{src:e.roomMinioUrl,alt:"",className:"rounded-lg w-full h-48 object-cover"})}),(0,a.jsxs)("div",{className:"flex justify-between",children:[(0,a.jsx)("h1",{className:"text-2xl font-semibold max-w-[170px] break-words overflow-hidden",children:e.bookingDescription}),n?(0,a.jsx)("button",{className:"bg-yellow-500 min-w-[120px] min-h-[35px] max-h-[35px] rounded-full text-white",onClick:()=>V(e.bookingId,e.bookingDescription),children:"Reject Message"}):(0,a.jsx)("button",{className:d?"bg-gray-200 min-w-[100px] min-h-[35px] max-h-[35px] rounded-full text-gray-400":"bg-red-600 min-w-[100px] min-h-[35px] max-h-[35px] rounded-full text-white",onClick:()=>{E(!0),M(e.bookingId)},disabled:!!d,children:"Cancel"})]}),(0,a.jsx)("div",{className:"",children:(0,a.jsx)("h3",{className:"text-base",children:e.roomName})}),(0,a.jsx)("div",{className:"grid grid-cols-2 gap-2 mb-2",children:e.sessionBookingList.map(e=>(0,a.jsx)("div",{className:"rounded-full flex justify-center py-1 ".concat(1==e.sessionId?"bg-red-800":2==e.sessionId?"bg-orange-800":3==e.sessionId?"bg-yellow-600":4==e.sessionId?"bg-emerald-800":5==e.sessionId?"bg-blue-900":6==e.sessionId&&"bg-pink-700"," "),children:(0,a.jsx)("p",{className:"text-xs text-white",children:e.sessionName})},e.sessionId))}),e.approvalHistories.map(e=>(0,a.jsxs)("div",{className:"relative flex items-center gap-2 group",children:[(0,a.jsx)("img",{src:e.approvalMinioUrl,alt:"",className:"rounded-full w-8 h-8 my-1 border-2 ".concat(1===e.approvalStatusId?"border-yellow-600":2===e.approvalStatusId?"border-green-600":"border-red-600")}),(0,a.jsx)("p",{children:e.approvalName}),(0,a.jsxs)("div",{className:"absolute left-0 bottom-12 hidden group-hover:block bg-gray-800 text-white text-sm p-2 rounded-md shadow-lg",children:[(0,a.jsxs)("p",{children:["Status: ",e.approvalStatus]}),(0,a.jsxs)("p",{children:[4===e.approvalStatusId?"Cancelled at :":3===e.approvalStatusId?"Rejected at:":"Approved at:"," ","0001-01-01T00:00:00"===e.approvedAt?"N/A":e.approvedAt]})]})]},e.approvalUserId))]})}),(0,a.jsxs)("div",{className:"mt-auto flex justify-end",children:[(0,a.jsx)("button",{className:"px-1 py-0.5 rounded-md border-2 ".concat(l),disabled:i,onClick:()=>ee(e.bookingId,e.qrMinioUrl,e.checkInPlace),children:(0,a.jsx)(r.G,{icon:x.rtB,className:"inline text-4xl ".concat(t)})}),(0,a.jsx)(g,{isOpen:z,onClose:es,qrUrl:I,bookingId:y,checkInPlace:C})]}),(0,a.jsx)(u.Z,{isOpen:O,onClose:K,bookingId:v,bookingName:R,roomName:e.roomName}),(0,a.jsx)(m,{visible:_,onConfirm:W,onCancel:$}),(0,a.jsx)(p,{visible:Y,onConfirm:J,isSuccess:L})]},e.bookingId)}):(0,a.jsxs)("div",{className:"flex absolute items-center",children:[(0,a.jsx)("p",{className:"text-white text-3xl font-bold mr-3",children:":)"}),(0,a.jsx)("p",{className:"text-white text-2xl font-normal",children:b?"Yay... No canceled bookings yet. Your cancelled bookings will show up here.":"Oops... No ongoing bookings. Book now by clicking on the Dashboard."})]})})]})};f.layout=i.f;var j=f}},function(e){e.O(0,[976,634,161,774,888,179],function(){return e(e.s=6644)}),_N_E=e.O()}]);
//# sourceMappingURL=ongoing-494d0c32a1429e1a.js.map