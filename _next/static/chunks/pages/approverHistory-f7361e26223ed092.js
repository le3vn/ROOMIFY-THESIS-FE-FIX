(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[499],{8954:function(e,l,o){(window.__NEXT_P=window.__NEXT_P||[]).push(["/approverHistory",function(){return o(3819)}])},2898:function(e,l,o){"use strict";var s=o(5893),t=o(9417),n=o(7814),r=o(7294);let i=e=>{let{isOpen:l,onClose:o,minioUrl:i}=e;return((0,r.useEffect)(()=>(l?document.body.style.overflow="hidden":document.body.style.overflow="unset",()=>{document.body.style.overflow="unset"}),[l]),l)?(0,s.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex justify-center items-center z-50",children:(0,s.jsxs)("div",{className:"bg-white p-4 rounded-lg w-3/4 h-3/4 overflow-auto",children:[(0,s.jsx)("div",{className:"flex justify-end",children:(0,s.jsx)("button",{className:"bg-gray-200 w-10 h-10 rounded-full",onClick:o,children:(0,s.jsx)(n.G,{icon:t.EOp})})}),(0,s.jsx)("div",{className:"flex justify-center items-center h-full p-6",children:(0,s.jsx)("img",{src:i,alt:"Evidence Preview",className:"max-w-full max-h-full"})})]})}):null};l.Z=i},3819:function(e,l,o){"use strict";o.r(l);var s=o(5893),t=o(7294),n=o(161),r=o(3299),i=o(1061),a=o(7814),d=o(9417),c=o(2898),u=o(1163);let x=()=>{var e,l;let o=(0,u.useRouter)(),{data:n}=(0,r.useSession)(),x=null==n?void 0:n.user,m=null==x?void 0:x.id,[f,v]=(0,t.useState)(!1),[h,p]=(0,t.useState)(null),[b,g]=(0,t.useState)(""),[N,j]=(0,t.useState)(!1),[k,w]=(0,t.useState)(null);(0,t.useEffect)(()=>{let e=async()=>{try{let e=await fetch("".concat(i.j.getApproverHistory,"?UserId=").concat(m,"&IsApproved=").concat(f));if(!e.ok)throw Error("Failed to fetch approval history");let l=await e.json();p(l)}catch(e){w(e instanceof Error?e.message:"Unknown error")}};m&&e()},[f,m]);let y=e=>{v(e)};if(k)return(0,s.jsxs)("div",{children:["Error loading data: ",k]});let U=e=>{g(e),j(!0)},S=e=>{o.push("/approverHistory/".concat(e))},R=e=>{if(!e){console.error("Booking data is not available.");return}let l="EVIDENCE_".concat(e.bookingDescription,"_").concat(e.bookingInstitutionalId,"_").concat(e.bookerName);("Staff"===e.bookerUserRole||"StudentOrganization"===e.bookerUserRole)&&(l+="_".concat(e.bookingOrganizationName));let o=e.evidenceMinioUrl.split(".").pop();l+=".".concat(o);let s=document.createElement("a");s.href=e.evidenceMinioUrl,s.download=l,s.click()};return(0,s.jsxs)("div",{className:"mt-3 h-[650px]",children:[(0,s.jsx)("img",{src:"/Assets/images/Approval-History.png",alt:"Ongoing",width:410,height:40,className:"mt-16"}),(0,s.jsxs)("div",{className:"flex mt-4 mb-6",children:[(0,s.jsx)("button",{className:"rounded-md text-white text-xl ".concat(f?"underline":""," ").concat(f?"underline-offset-8":""),onClick:()=>y(!0),children:"Approved"}),(0,s.jsx)("button",{className:"rounded-md ml-8 text-white text-xl ".concat(f?"":"underline"," ").concat(f?"":"underline-offset-8"),onClick:()=>y(!1),children:"Rejected"})]}),(0,s.jsxs)("div",{className:"mt-8 grid grid-cols-3 gap-5 overflow-y-auto h-[500px]",children:[null==h?void 0:null===(e=h.approverHistoryViewModel)||void 0===e?void 0:e.map((e,l)=>(0,s.jsx)("div",{className:"bg-white p-4 rounded-lg h-[250px] overflow-y-auto",children:(0,s.jsxs)("div",{className:"flex flex-col h-full",children:[(0,s.jsx)("div",{className:"",children:(0,s.jsxs)("p",{className:"text-2xl font-semibold",children:['"',e.bookingDescription,'"']})}),(0,s.jsx)("div",{className:"",children:(0,s.jsx)("p",{className:"text-lg",children:e.roomName})}),(0,s.jsxs)("div",{className:"flex flex-col gap-1 mb-2",children:[(0,s.jsx)("p",{className:"text-xs",children:" Submitted By :"}),(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsx)("img",{src:e.bookerMinioUrl,alt:"",className:"w-10 h-10 rounded-full border-2 border-purple-950"}),(null==e?void 0:e.bookerUserRole)==="Staff"||(null==e?void 0:e.bookerUserRole)==="StudentOrganization"?(0,s.jsxs)("div",{className:"flex flex-col",children:[(0,s.jsxs)("p",{className:"",children:[null==e?void 0:e.bookingInstitutionalId," - ",null==e?void 0:e.bookerName]}),(0,s.jsx)("p",{className:"",children:null==e?void 0:e.bookingOrganizationName})]}):(0,s.jsx)("div",{children:(0,s.jsxs)("p",{children:[null==e?void 0:e.bookingInstitutionalId," - ",null==e?void 0:e.bookerName]})})]})]}),(0,s.jsx)("div",{className:"",children:e.approverHistory.map(e=>(0,s.jsx)("div",{className:"flex justify-center",children:(0,s.jsx)("p",{className:"".concat(2==e.statusId?"text-green-600":"text-red-600"," text-2xl font-bold"),children:e.statusName})},e.approverUserId))}),(0,s.jsxs)("div",{className:"h-full flex justify-center items-center gap-4",children:[(0,s.jsx)("button",{className:"w-10 h-10 rounded-full \n                                                ".concat((null==e?void 0:e.bookerUserRole)=="Staff"||(null==e?void 0:e.bookerUserRole)=="Student"||(null==e?void 0:e.bookerUserRole)=="Lecturer"?"bg-gray-200 border-2 border-gray-400":"bg-purple-950"),disabled:(null==e?void 0:e.bookerUserRole)=="Staff"||(null==e?void 0:e.bookerUserRole)=="Student"||(null==e?void 0:e.bookerUserRole)=="Lecturer",onClick:()=>U((null==e?void 0:e.evidenceMinioUrl)||""),children:(0,s.jsx)(a.G,{icon:d.Mdf,className:"inline text-white"})}),(0,s.jsx)("button",{className:"w-10 h-10 rounded-full \n                                            ".concat((null==e?void 0:e.bookerUserRole)=="Staff"||(null==e?void 0:e.bookerUserRole)=="Student"||(null==e?void 0:e.bookerUserRole)=="Lecturer"?"bg-gray-200 border-2 border-gray-400":"bg-purple-950"),onClick:()=>e?R(e):null,disabled:(null==e?void 0:e.bookerUserRole)=="Staff"||(null==e?void 0:e.bookerUserRole)=="Student"||(null==e?void 0:e.bookerUserRole)=="Lecturer",children:(0,s.jsx)(a.G,{icon:d.q7m,className:"inline text-white"})}),(0,s.jsx)("button",{className:"bg-purple-950 w-10 h-10 rounded-full",onClick:()=>S(e.bookingId),children:(0,s.jsx)(a.G,{icon:d.wn1,className:"inline text-white"})})]})]})},l)),!(null==h?void 0:null===(l=h.approverHistoryViewModel)||void 0===l?void 0:l.length)&&(0,s.jsxs)("div",{className:"flex absolute items-center",children:[(0,s.jsx)("p",{className:"text-white text-3xl font-bold mr-3",children:":)"}),(0,s.jsx)("p",{className:"text-white text-2xl font-normal",children:"No Approved bookings yet. Your approvals on bookings will show up here."})]})]}),(0,s.jsx)(c.Z,{isOpen:N,onClose:()=>j(!1),minioUrl:b})]})};x.layout=n.f,l.default=x}},function(e){e.O(0,[976,634,161,774,888,179],function(){return e(e.s=8954)}),_N_E=e.O()}]);
//# sourceMappingURL=approverHistory-f7361e26223ed092.js.map